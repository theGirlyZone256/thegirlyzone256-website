[build]
  publish = "_site"
  command = "npm run build"

[build.environment]
  NODE_VERSION = "18"

# 1. Page Mappings (Using specific matches only)
[[redirects]]
  from = "/cart"
  to = "/pages/cart/index.html"
  status = 200

[[redirects]]
  from = "/favourites"
  to = "/pages/favourites/index.html"
  status = 200

[[redirects]]
  from = "/success"
  to = "/success/index.html"
  status = 200

# 2. Security Headers
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"

# 3. Sitemap
[[plugins]]
package = "@netlify/plugin-sitemap"
  [plugins.inputs]
  buildDir = "_site"

# NOTE: The "/*" to "/out-of-stock.html" rule has been REMOVED.
# This will force Netlify to show your real index.html.