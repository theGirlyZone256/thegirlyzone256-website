[build]
  publish = "_site"
  command = "npm run build"

[build.environment]
  NODE_VERSION = "18"

# 1. Primary Domain Redirect
[[redirects]]
  from = "https://thegirlyzone.netlify.app/*"
  to = "https://thegirlyzone.com/:splat"
  status = 301
  force = true

# 2. Specific Page Mappings
[[redirects]]
  from = "/cart"
  to = "/pages/cart/index.html"
  status = 200

[[redirects]]
  from = "/favourites"
  to = "/pages/favourites/index.html"
  status = 200

[[redirects]]
  from = "/success"
  to = "/success/index.html"
  status = 200

# 3. Security
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"

# 4. Plugins
[[plugins]]
package = "@netlify/plugin-sitemap"
  [plugins.inputs]
  buildDir = "_site"

# 5. Global 404 Catch-all
# We use /out-of-stock.html without a status 200 redirect above it
# to ensure it only triggers when a file is truly missing.
[[redirects]]
  from = "/*"
  to = "/out-of-stock.html"
  status = 404