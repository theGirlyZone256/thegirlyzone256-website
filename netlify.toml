[build]
  publish = "_site"
  command = "npm run build"

[build.environment]
  NODE_VERSION = "18"

# 1. Page Mappings
[[redirects]]
  from = "/cart"
  to = "/pages/cart/index.html"
  status = 200

[[redirects]]
  from = "/favourites"
  to = "/pages/favourites/index.html"
  status = 200

[[redirects]]
  from = "/success"
  to = "/success/index.html"
  status = 200

# 2. Security Headers
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"

# 3. Sitemap
[[plugins]]
package = "@netlify/plugin-sitemap"
  [plugins.inputs]
  buildDir = "_site"

# 4. The 404 Custom Page (Fixed!)
# By setting force = false, it won't hide your homepage anymore.
# It will only pop up if someone types a broken URL.
[[redirects]]
  from = "/*"
  to = "/out-of-stock.html"
  status = 404
  force = false